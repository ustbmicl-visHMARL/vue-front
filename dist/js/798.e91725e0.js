"use strict";(self["webpackChunkvue_library"]=self["webpackChunkvue_library"]||[]).push([[798],{7798:function(t,e,i){i.r(e),i.d(e,{default:function(){return d}});var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"notice-list maxWH clearfix"},[e("div",{staticClass:"search"},[e("el-form",{ref:"searchNoticeForm",staticClass:"flex maxWH search-form",attrs:{model:t.searchForm,"label-width":"80px"}},[e("el-form-item",{attrs:{label:"标题",prop:"notice_title"}},[e("el-input",{attrs:{placeholder:"请输入想查询的通知标题"},model:{value:t.searchForm.notice_title,callback:function(e){t.$set(t.searchForm,"notice_title","string"===typeof e?e.trim():e)},expression:"searchForm.notice_title"}})],1),e("el-form-item",{staticClass:"flex",staticStyle:{overflow:"hidden"}},[e("el-button",{attrs:{type:"primary"},nativeOn:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.search.apply(null,arguments)}}},[t._v("搜索")]),e("el-button",{nativeOn:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.resetForm("searchNoticeForm")}}},[t._v("重置")])],1)],1)],1),e("el-button",{staticStyle:{margin:"15px 0"},attrs:{type:"primary"},nativeOn:{click:function(e){e.preventDefault(),e.stopPropagation(),t.noticeAddDialog=!0}}},[t._v("发布通知")]),e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.noticelist,border:"","max-height":"250"}},[e("el-table-column",{attrs:{prop:"notice_title",label:"标题","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{label:"详情","header-align":"center",align:"center"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("div",{staticClass:"handler"},[e("el-button",{attrs:{type:"info"},nativeOn:{click:function(e){return e.preventDefault(),t.showNoticeDetail(i.$index,t.noticelist)}}},[t._v(" 查看 ")])],1)]}}])}),e("el-table-column",{attrs:{prop:"create_time",label:"创建时间","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{label:"操作","header-align":"center",align:"center"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("div",{staticClass:"handler"},[e("el-button",{attrs:{type:"danger"},nativeOn:{click:function(e){return e.preventDefault(),t.delNotice(i.$index,t.noticelist)}}},[t._v(" 删除 ")])],1)]}}])})],1),e("el-pagination",{staticStyle:{padding:"10px 0"},attrs:{"current-page":t.page_no,"page-sizes":t.page_sizes,"page-size":t.page_size,layout:"total, sizes, prev, pager, next, jumper",total:t.notice_count},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}}),e("el-dialog",{attrs:{title:"发布通知",visible:t.noticeAddDialog},on:{"update:visible":function(e){t.noticeAddDialog=e}}},[e("el-form",{ref:"noticeAddForm",attrs:{model:t.noticeAddForm,"label-width":"80px",rules:t.rules}},[e("el-form-item",{attrs:{label:"标题",prop:"notice_title"}},[e("el-input",{attrs:{autocomplete:"off",placeholder:"请输入标题"},model:{value:t.noticeAddForm.notice_title,callback:function(e){t.$set(t.noticeAddForm,"notice_title","string"===typeof e?e.trim():e)},expression:"noticeAddForm.notice_title"}})],1),e("el-form-item",{attrs:{label:"详情",prop:"notice_detail"}},[e("el-input",{attrs:{rows:5,type:"textarea",autocomplete:"off",placeholder:"请输入通知详情"},model:{value:t.noticeAddForm.notice_detail,callback:function(e){t.$set(t.noticeAddForm,"notice_detail","string"===typeof e?e.trim():e)},expression:"noticeAddForm.notice_detail"}})],1)],1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer",align:"center"},slot:"footer"},[e("el-button",{attrs:{type:"primary"},nativeOn:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.addNotice("noticeAddForm")}}},[t._v("确 定")]),e("el-button",{nativeOn:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.resetForm("noticeAddForm")}}},[t._v("重 置")])],1)],1)],1)},o=[],s=i(3822),n={name:"NoticeList",data(){const t=(t,e,i)=>{const a=/^[0-9A-Za-z\u4e00-\u9fa5,!.*&^%#+=-_:;。，！「」——~、@]{3,12}$/;e.trim().length<=0?i(new Error("请输入标题")):a.test(e.trim())?i():i(new Error("标题由3到12位的数字、字母、汉字或部分符号组成"))},e=(t,e,i)=>{const a=/^[0-9A-Za-z\u4e00-\u9fa5,!.*&^%#+=-_:;。，！…. ：；，「」——~、\s@]{15,100}$/;e.trim().length<=0?i(new Error("请输入通知详情")):a.test(e.trim())?i():i(new Error("通知详情由15到100位的数字、字母、汉字或部分符号组成"))};return{rules:{notice_title:[{required:!0,trigger:["blur","change"],validator:t}],notice_detail:[{required:!0,trigger:"blur",validator:e}]},searchForm:{notice_title:""},noticeAddDialog:!1,page_no:1,page_size:8,page_sizes:[8,16,30,50,100],noticeAddForm:{notice_title:"",notice_detail:""}}},computed:{...(0,s.Se)(["noticelist","notice_count"])},mounted(){this.getNoticeList()},methods:{resetForm(t){this.$refs[t].resetFields()},showNoticeDetail(t,e){const i=e[t].notice_title,a=e[t].notice_detail;this.$alert(a,i,{confirmButtonText:"确定",callback:t=>"ok"})},search(){this.page_no=1,this.page_size=this.page_sizes[0],this.getNoticeList()},handleSizeChange(t){this.page_size=t,this.page_no=1,this.getNoticeList()},handleCurrentChange(t){this.page_no=t,this.getNoticeList()},async addNotice(t){await this.$refs[t].validate((async e=>{if(e)try{await this.$store.dispatch("addNotice",JSON.stringify(this.noticeAddForm)).then((e=>{this.resetForm(t),this.noticeAddDialog=!1,this.$message({type:"success",message:e}),this.getNoticeList()})).catch((t=>this.$message({type:"warning",message:t.message})))}catch(i){this.$message({type:"warning",message:i.message})}}))},async getNoticeList(){try{const{page_no:t,page_size:e}=this;let i=this.searchForm.notice_title;const a=/^[0-9A-Za-z\u4e00-\u9fa5,!.*&^%#+=-_:;。，！「」——~、@]{1,12}$/;a.test(i)||""!==i&&(i="1111111111111111111111111111111111111"),await this.$store.dispatch("getNoticeList",JSON.stringify({page_no:t,page_size:e,notice_title:i}))}catch(t){this.$message({type:"warning",message:t.message})}},async delNotice(t,e){const i=e[t].notice_title,a=e[t].notice_id;await this.$confirm(`是否删除通知 [${i}] ?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{try{await this.$store.dispatch("delNotice",{notice_id:a}).then((t=>{this.$message({type:"success",message:t}),this.getNoticeList()})).catch((t=>this.$message({type:"warning",message:t.message})))}catch(t){this.$message({type:"warning",message:t.message})}})).catch((()=>{this.$message({type:"info",message:"已取消"})}))}}},r=n,l=i(1001),c=(0,l.Z)(r,a,o,!1,null,"10149f77",null),d=c.exports}}]);
//# sourceMappingURL=798.e91725e0.js.map
"use strict";(self["webpackChunkvue_library"]=self["webpackChunkvue_library"]||[]).push([[349],{8349:function(t,e,a){a.r(e),a.d(e,{default:function(){return h}});var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"seatlist maxWH clearfix"},[e("div",{staticClass:"search"},[e("el-form",{ref:"searchSeatForm",staticClass:"flex maxWH search-form",attrs:{model:t.searchForm,"label-width":"80px"}},[e("el-form-item",{attrs:{label:"座位编号",prop:"seat_no"}},[e("el-input",{attrs:{placeholder:"请输入想查询的座位编号"},model:{value:t.searchForm.seat_no,callback:function(e){t.$set(t.searchForm,"seat_no","string"===typeof e?e.trim():e)},expression:"searchForm.seat_no"}})],1),e("el-form-item",{attrs:{label:"座位状态",prop:"seat_status"}},[e("el-select",{attrs:{placeholder:"请选择座位状态"},model:{value:t.searchForm.seat_status,callback:function(e){t.$set(t.searchForm,"seat_status",e)},expression:"searchForm.seat_status"}},t._l(t.seat_status,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),e("el-form-item",{staticClass:"flex",staticStyle:{overflow:"hidden"}},[e("el-button",{attrs:{type:"primary"},nativeOn:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.search.apply(null,arguments)}}},[t._v("搜索")]),e("el-button",{nativeOn:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.resetSearchForm("searchSeatForm")}}},[t._v("重置")])],1)],1)],1),e("el-button",{staticStyle:{margin:"15px 0"},attrs:{type:"primary"},nativeOn:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.addSeat.apply(null,arguments)}}},[t._v("添加座位")]),e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.seatlist,border:"","max-height":"250"}},[e("el-table-column",{attrs:{prop:"seat_no",label:"座位编号"}}),e("el-table-column",{attrs:{prop:"seat_status",label:"座位状态"}}),e("el-table-column",{attrs:{prop:"use_count",label:"使用次数"}}),e("el-table-column",{attrs:{prop:"create_time",label:"创建时间","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{label:"操作","header-align":"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticClass:"handler flex-center"},[e("el-button",{attrs:{type:"warning"},nativeOn:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.updateSeat(a.$index,t.seatlist)}}},[t._v(" 修改 ")]),e("el-button",{attrs:{type:"danger"},nativeOn:{click:function(e){return e.preventDefault(),t.delSeat(a.$index,t.seatlist)}}},[t._v(" 移除 ")])],1)]}}])})],1),e("el-pagination",{staticStyle:{padding:"10px 0"},attrs:{"current-page":t.page_no,"page-sizes":t.page_sizes,"page-size":t.page_size,layout:"total, sizes, prev, pager, next, jumper",total:t.seat_count},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)},n=[],r=a(86),i=a(3822),o={name:"SeatList",data(){return{seat_status:[{label:"全部",value:"0"},{label:r.Bv,value:"1"},{label:r.QR,value:"2"}],searchForm:{seat_no:"",seat_status:""},seatAddDialog:!1,seatUpdateDialog:!1,page_no:1,page_size:8,page_sizes:[8,16,30,50,100]}},computed:{...(0,i.Se)(["seatlist","seat_count"])},mounted(){this.searchForm.seat_status=this.seat_status[0].value,this.getSeatList()},methods:{resetForm(t){this.$refs[t].resetFields()},resetSearchForm(t){this.resetForm(t),this.searchForm.seat_status=this.seat_status[0].value},async addSeat(){await this.$prompt("请输入座位编号","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^[1-5]-[1-9][0-9][1-9]$/,inputErrorMessage:"座位编号格式: 楼层-号码"}).then((async({value:t})=>{try{const e=t;await this.$store.dispatch("addSeat",JSON.stringify({seat_no:e})).then((t=>{this.$message({type:"success",message:t}),this.getSeatList()})).catch((t=>{this.$message({type:"warning",message:t.message})}))}catch(e){this.$message({type:"info",message:e.message})}})).catch((()=>{this.$message({type:"info",message:"取消输入"})}))},async updateSeat(t,e){const a=e[t].seat_id;await this.$prompt("请输入座位编号","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^[1-5]-[1-9][0-9][1-9]$/,inputErrorMessage:"座位编号格式: 楼层-号码"}).then((async({value:t})=>{try{const e=t;await this.$store.dispatch("backUpdateSeatInfo",JSON.stringify({seat_id:a,seat_no:e})).then((t=>{this.$message({type:"success",message:t}),this.getSeatList()})).catch((t=>{this.$message({type:"warning",message:t.message})}))}catch(e){this.$message({type:"warning",message:e.message})}})).catch((()=>{this.$message({type:"info",message:"取消输入"})}))},async delSeat(t,e){const a=e[t].seat_no,s=e[t].seat_id;await this.$confirm(`是否移除座位 [${a}] ?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{try{await this.$store.dispatch("delSeat",{seat_id:s}).then((t=>{this.$message({type:"success",message:t}),this.getSeatList()})).catch((t=>this.$message({type:"warning",message:t.message})))}catch(t){this.$message({type:"warning",message:t.message})}})).catch((()=>{this.$message({type:"info",message:"已取消"})}))},handleSizeChange(t){this.page_size=t,this.page_no=1,this.getSeatList()},handleCurrentChange(t){this.page_no=t,this.getSeatList()},async getSeatList(){try{const{page_no:t,page_size:e}=this;let a=this.searchForm.seat_no;const s=/^[0-9-]{1,5}$/;s.test(a)||""!==a&&(a="1111111111111111111111111111111111111");let n=Number.parseInt(this.searchForm.seat_status)||0;0===n?n="全部":1===n?n=r.Bv:2===n&&(n=r.QR),await this.$store.dispatch("getSeatList",JSON.stringify({page_no:t,page_size:e,seat_no:a,seat_status:n}))}catch(t){this.$message({type:"warning",message:t.message})}},search(){this.page_no=1,this.page_size=this.page_sizes[0],this.getSeatList()}}},l=o,c=a(1001),u=(0,c.Z)(l,s,n,!1,null,"58de28b2",null),h=u.exports},86:function(t,e,a){a.d(e,{Bv:function(){return c},KM:function(){return l},Kb:function(){return o},QR:function(){return u},_h:function(){return i},pv:function(){return n},sX:function(){return r},st:function(){return s}});const s="正常",n="封禁",r="正常",i="封禁",o="管理员",l="用户",c="使用中",u="空闲中"}}]);
//# sourceMappingURL=349.17edd230.js.map
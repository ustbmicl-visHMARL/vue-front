"use strict";(self["webpackChunkvue_library"]=self["webpackChunkvue_library"]||[]).push([[240],{2240:function(t,e,a){a.r(e),a.d(e,{default:function(){return h}});var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"notice maxWH"},[t._m(0),e("main",{staticClass:"main"},[e("div",{staticClass:"read flex-center"},[e("el-button",{attrs:{type:"text",disabled:t.readlist.length<1},nativeOn:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.setAllRead.apply(null,arguments)}}},[t._v("全部已读")])],1),e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.front_notice_list,height:"350"}},[e("el-table-column",{attrs:{prop:"notice_title"},scopedSlots:t._u([{key:"default",fn:function(a){return e("span",{staticStyle:{position:"relative"}},[e("p",[t._v(t._s(a.row.notice_title))]),e("span",[t._v(t._s(t.friendlyDate(a.row.create_time)))]),"未读"===a.row.is_read?e("i",{staticClass:"el-icon-warning",staticStyle:{position:"absolute",top:"60%",transform:"translateY(-50%)",color:"tomato"}}):t._e()])}}])}),e("el-table-column",{attrs:{"header-align":"center",align:"right"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticClass:"handler"},[e("el-button",{attrs:{type:"info",round:""},nativeOn:{click:function(e){return e.preventDefault(),t.showNoticeDetail(a.$index,t.front_notice_list)}}},[t._v(" 查看 ")])],1)]}}])})],1)],1)])},i=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"header flex"},[e("span",{staticClass:"title"},[t._v("消息通知")])])}],n=a(3822);function o(t){t=new Date(t);let e={year:"%n% 年前",month:"%n% 月前",day:"%n% 天前",hour:"%n% 小时前",minute:"%n% 分钟前",second:"%n% 秒前"},a=Date.now(),s=Math.floor((a-t)/1e3),i=Math.floor(s/60),n=Math.floor(i/60),o=Math.floor(n/24),r=Math.floor(o/30),l=Math.floor(r/12),c="",u=0;return l>0?(c="year",u=l):r>0?(c="month",u=r):o>0?(c="day",u=o):n>0?(c="hour",u=n):i>0?(c="minute",u=i):(c="second",u=0===s?s=1:s),e[c].replace("%n%",u)}var r=o,l={name:"Notice",data(){return{friendlyDate:r}},computed:{...(0,n.Se)(["front_notice_list","readlist","userinfo"])},mounted(){this.getNoticeList()},methods:{async getUserInfo(t){try{await this.$store.dispatch("getUserInfo",{user_id:t})}catch(e){console.warn(e.message)}},async getNoticeList(){try{await this.$store.dispatch("frontGetNoticeList",{user_id:this.userinfo.user_id})}catch(t){this.$message({type:"warning",message:t.message})}},async showNoticeDetail(t,e){const{notice_title:a,notice_detail:s,notice_id:i,is_read:n,user_id:o}=e[t];await this.$alert(s,a,{confirmButtonText:"确定",callback:async t=>("已读"!==n&&(await this.setRead(o,i),await this.getUserInfo(o),await this.getNoticeList()),"ok")})},async setRead(t,e){try{await this.$store.dispatch("frontSetRead",{user_id:t,notice_id:e})}catch(a){console.warn(a.message)}},async setAllRead(){try{const t=this.userinfo.user_id;await this.$store.dispatch("frontAllSetRead",{user_id:t}).then((async e=>{await this.getUserInfo(t),await this.getNoticeList(),this.$notify({title:"成功",type:"success",message:"已清空未读通知"})}))}catch(t){console.warn(t.message)}}}},c=l,u=a(1001),d=(0,u.Z)(c,s,i,!1,null,"415af1fa",null),h=d.exports}}]);
//# sourceMappingURL=240.5e0fe83c.js.map
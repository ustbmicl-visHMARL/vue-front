"use strict";(self["webpackChunkvue_library"]=self["webpackChunkvue_library"]||[]).push([[778],{1778:function(e,t,s){s.r(t),s.d(t,{default:function(){return d}});var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"user-list maxWH clearfix"},[t("div",{staticClass:"search"},[t("el-form",{ref:"searchTestForm",staticClass:"flex maxWH search-form",attrs:{model:e.searchForm,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"账号",prop:"account"}},[t("el-input",{attrs:{placeholder:"请输入想查询的账号"},model:{value:e.searchForm.account,callback:function(t){e.$set(e.searchForm,"account","string"===typeof t?t.trim():t)},expression:"searchForm.account"}})],1),t("el-form-item",{attrs:{label:"用户名",prop:"username"}},[t("el-input",{attrs:{placeholder:"请输入想查询的用户名"},model:{value:e.searchForm.username,callback:function(t){e.$set(e.searchForm,"username","string"===typeof t?t.trim():t)},expression:"searchForm.username"}})],1),t("el-form-item",{attrs:{label:"用户状态",prop:"user_status"}},[t("el-select",{attrs:{placeholder:"请选择用户状态"},model:{value:e.searchForm.user_status,callback:function(t){e.$set(e.searchForm,"user_status",t)},expression:"searchForm.user_status"}},e._l(e.user_status,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{staticClass:"flex",staticStyle:{"margin-left":"-70px",overflow:"hidden"}},[t("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.search.apply(null,arguments)}}},[e._v("搜索")]),t("el-button",{nativeOn:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.resetSearchForm("searchUserForm")}}},[e._v("重置")])],1)],1)],1),t("el-button",{staticStyle:{margin:"15px 0"},attrs:{type:"primary"},nativeOn:{click:function(t){t.preventDefault(),t.stopPropagation(),e.userAddDialog=!0}}},[e._v("添加用户")]),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.userlist,border:"","max-height":"250"}},[t("el-table-column",{attrs:{prop:"account",label:"账号","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"username",label:"用户名"}}),t("el-table-column",{attrs:{prop:"user_status",label:"用户状态"}}),t("el-table-column",{attrs:{prop:"create_time",label:"创建时间","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"login_time",label:"上次登录时间","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{label:"操作","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("div",{staticClass:"handler flex-center"},[t("el-button",{attrs:{type:"warning"},nativeOn:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.openUpdateUser(s.$index,e.userlist)}}},[e._v(" 修改 ")]),t("el-button",{attrs:{type:"danger"},nativeOn:{click:function(t){return t.preventDefault(),e.delUser(s.$index,e.userlist)}}},[e._v(" 封禁 ")])],1)]}}])})],1),t("el-pagination",{staticStyle:{padding:"10px 0"},attrs:{"current-page":e.page_no,"page-sizes":e.page_sizes,"page-size":e.page_size,layout:"total, sizes, prev, pager, next, jumper",total:e.user_count},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),t("el-dialog",{attrs:{title:"添加用户",visible:e.userAddDialog},on:{"update:visible":function(t){e.userAddDialog=t}}},[t("el-form",{ref:"userAddForm",attrs:{model:e.userAddForm,"label-width":"80px",rules:e.rules}},[t("el-form-item",{attrs:{label:"账号",prop:"account"}},[t("el-input",{attrs:{autocomplete:"off",placeholder:"请输入账号"},model:{value:e.userAddForm.account,callback:function(t){e.$set(e.userAddForm,"account","string"===typeof t?t.trim():t)},expression:"userAddForm.account"}})],1),t("el-form-item",{attrs:{label:"用户名",prop:"username"}},[t("el-input",{attrs:{autocomplete:"off",placeholder:"请输入用户名"},model:{value:e.userAddForm.username,callback:function(t){e.$set(e.userAddForm,"username","string"===typeof t?t.trim():t)},expression:"userAddForm.username"}})],1),t("el-form-item",{attrs:{label:"密码",prop:"password"}},[t("el-input",{attrs:{type:"password",autocomplete:"off",placeholder:"请输入密码"},model:{value:e.userAddForm.password,callback:function(t){e.$set(e.userAddForm,"password","string"===typeof t?t.trim():t)},expression:"userAddForm.password"}})],1),t("el-form-item",{attrs:{label:"确认密码",prop:"adduserpwd1"}},[t("el-input",{attrs:{type:"password",autocomplete:"off",placeholder:"请确认密码"},model:{value:e.userAddForm.adduserpwd1,callback:function(t){e.$set(e.userAddForm,"adduserpwd1","string"===typeof t?t.trim():t)},expression:"userAddForm.adduserpwd1"}})],1),t("el-form-item",{attrs:{label:"用户状态",prop:"user_status"}},[t("el-radio-group",{model:{value:e.userAddForm.user_status,callback:function(t){e.$set(e.userAddForm,"user_status",t)},expression:"userAddForm.user_status"}},[t("el-radio",{attrs:{label:e.user_status[1].label}}),t("el-radio",{attrs:{label:e.user_status[2].label}})],1)],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer",align:"center"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.addUser("userAddForm")}}},[e._v("确 定")]),t("el-button",{nativeOn:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.resetForm("userAddForm")}}},[e._v("重 置")])],1)],1),t("el-dialog",{attrs:{title:"修改用户信息",visible:e.userUpdateDialog},on:{"update:visible":function(t){e.userUpdateDialog=t}}},[t("el-form",{ref:"userUpdateForm",attrs:{model:e.userUpdateForm,"label-width":"80px",rules:e.rules,"hide-required-asterisk":""}},[t("el-form-item",{attrs:{label:"账号"}},[t("el-input",{attrs:{disabled:"",autocomplete:"off",placeholder:"请输入账号"},model:{value:e.userUpdateForm.account,callback:function(t){e.$set(e.userUpdateForm,"account","string"===typeof t?t.trim():t)},expression:"userUpdateForm.account"}})],1),t("el-form-item",{attrs:{label:"用户名"}},[t("el-input",{attrs:{disabled:"",autocomplete:"off",placeholder:"请输入用户名"},model:{value:e.userUpdateForm.username,callback:function(t){e.$set(e.userUpdateForm,"username","string"===typeof t?t.trim():t)},expression:"userUpdateForm.username"}})],1),t("el-form-item",{attrs:{label:"修改密码",prop:"update_pwd"}},[t("el-switch",{model:{value:e.userUpdateForm.update_pwd,callback:function(t){e.$set(e.userUpdateForm,"update_pwd","string"===typeof t?t.trim():t)},expression:"userUpdateForm.update_pwd"}})],1),e.userUpdateForm.update_pwd?t("el-form-item",{attrs:{label:"密码",prop:"password"}},[t("el-input",{attrs:{type:"password",disabled:!e.userUpdateForm.update_pwd,autocomplete:"off",placeholder:"请输入密码"},model:{value:e.userUpdateForm.password,callback:function(t){e.$set(e.userUpdateForm,"password","string"===typeof t?t.trim():t)},expression:"userUpdateForm.password"}})],1):e._e(),e.userUpdateForm.update_pwd?t("el-form-item",{attrs:{label:"确认密码",prop:"updateuserpwd1"}},[t("el-input",{attrs:{type:"password",disabled:!e.userUpdateForm.update_pwd,autocomplete:"off",placeholder:"请确认密码"},model:{value:e.userUpdateForm.updateuserpwd1,callback:function(t){e.$set(e.userUpdateForm,"updateuserpwd1","string"===typeof t?t.trim():t)},expression:"userUpdateForm.updateuserpwd1"}})],1):e._e(),t("el-form-item",{attrs:{label:"用户状态",prop:"user_status"}},[t("el-radio-group",{model:{value:e.userUpdateForm.user_status,callback:function(t){e.$set(e.userUpdateForm,"user_status",t)},expression:"userUpdateForm.user_status"}},[t("el-radio",{attrs:{label:e.user_status[1].label}}),t("el-radio",{attrs:{label:e.user_status[2].label}})],1)],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer",align:"center"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.updateUser("userUpdateForm")}}},[e._v("确 定")]),t("el-button",{nativeOn:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.resetForm("userUpdateForm")}}},[e._v("重 置")])],1)],1)],1)},a=[],o=s(86),u=s(3822),l={name:"UserList",data(){const e=(e,t,s)=>{const r=/^[0-9]{6,12}$/;t.trim().length<=0?s(new Error("请输入账号")):r.test(t.trim())?s():s(new Error("账号由6到12位的数字组成"))},t=(e,t,s)=>{const r=/^[\u4e00-\u9fa5]{2,6}$/;t.trim().length<=0?s(new Error("请输入用户名")):r.test(t.trim())?s():s(new Error("用户名由2到6位的汉字组成"))},s=(e,t,s)=>{const r=/^[a-zA-Z0-9_]{8,12}$/;t.trim().length<=0?s(new Error("请输入密码")):r.test(t.trim())?s():s(new Error("密码由8到12位的字母、数字或下划线组成"))},r=(e,t,s)=>{""===this.userAddForm.password.trim()?s(new Error("请先输入密码")):t.trim().length<=0?s(new Error("确认密码不得为空")):t.trim()!==this.userAddForm.password?s(new Error("两次输入密码不一致")):s()},a=(e,t,s)=>{""===this.userUpdateForm.password.trim()?s(new Error("请先输入密码")):t.trim().length<=0?s(new Error("确认密码不得为空")):t.trim()!==this.userUpdateForm.password?s(new Error("两次输入密码不一致")):s()};return{rules:{account:[{required:!0,trigger:["blur","change"],validator:e}],username:[{required:!0,trigger:["blur","change"],validator:t}],password:[{required:!0,trigger:["blur","change"],validator:s}],adduserpwd1:[{required:!0,trigger:["blur","change"],validator:r}],updateuserpwd1:[{required:!0,trigger:["blur","change"],validator:a}],user_status:[{required:!0,message:"请选择用户状态",trigger:"change"}]},user_status:[{label:"全部",value:"0"},{label:o.st,value:"1"},{label:o.pv,value:"2"}],searchForm:{account:"",username:"",user_status:""},page_no:1,page_size:8,page_sizes:[8,16,30,50,100],userAddDialog:!1,userUpdateDialog:!1,userAddForm:{account:"",username:"",password:"",adduserpwd1:"",user_status:o.st},userUpdateForm:{user_id:0,account:"",username:"",update_pwd:!1,password:"",updateuserpwd1:"",user_status:o.st}}},watch:{"userUpdateForm.update_pwd":{deep:!0,handler(e){e||(this.userUpdateForm.password="",this.userUpdateForm.updateuserpwd1="")}}},computed:{...(0,u.Se)(["user_id","userlist","user_count"])},mounted(){this.searchForm.user_status=this.user_status[0].value,this.getUserList()},methods:{resetForm(e){this.$refs[e].resetFields()},async addUser(e){await this.$refs[e].validate((async t=>{if(t)try{await this.$store.dispatch("addUser",JSON.stringify(this.userAddForm)).then((t=>{this.resetForm(e),this.userAddDialog=!1,this.$message({type:"success",message:t}),this.getUserList()})).catch((e=>this.$message({type:"warning",message:e.message})))}catch(s){this.$message({type:"warning",message:s.message})}}))},openUpdateUser(e,t){this.userUpdateDialog=!0;const s=t[e];this.userUpdateForm={user_id:s.user_id,account:s.account,username:s.username,update_pwd:!1,password:"",updateuserpwd1:"",user_status:s.user_status}},async updateUser(e){await this.$refs[e].validate((async t=>{if(t)try{const t={user_id:this.userUpdateForm.user_id,password:this.userUpdateForm.password,user_status:this.userUpdateForm.user_status};await this.$store.dispatch("backUpdateUserInfo",JSON.stringify(t)).then((t=>{this.resetForm(e),this.userUpdateDialog=!1,this.$message({type:"success",message:t}),this.getUserList()})).catch((e=>this.$message({type:"warning",message:e.message})))}catch(s){this.$message({type:"warning",message:s.message})}}))},async delUser(e,t){const s=t[e].username,r=t[e].user_id;await this.$confirm(`是否封禁用户 [${s}] ?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{try{await this.$store.dispatch("delUser",{user_id:r}).then((e=>{this.$message({type:"success",message:e}),this.getUserList()})).catch((e=>this.$message({type:"warning",message:e.message})))}catch(e){this.$message({type:"warning",message:e.message})}})).catch((()=>{this.$message({type:"info",message:"已取消"})}))},handleSizeChange(e){this.page_size=e,this.page_no=1,this.getUserList()},handleCurrentChange(e){this.page_no=e,this.getUserList()},async getUserList(){try{const{page_no:e,page_size:t}=this;let s=this.searchForm.account;const r=/^[0-9]{1,12}$/;r.test(s)||""!==s&&(s="1111111111111111111111111111111111111");let a=this.searchForm.username;const u=/^[\u4e00-\u9fa50-9a-zA-Z]{1,6}$/;u.test(a)||""!==a&&(a="1111111111111111111111111111111111111");let l=Number.parseInt(this.searchForm.user_status)||0;0===l?l="全部":1===l?l=o.st:2===l&&(l=o.pv),await this.$store.dispatch("getUserList",JSON.stringify({page_no:e,page_size:t,account:s,username:a,user_status:l}))}catch(e){this.$message({type:"warning",message:e.message})}},resetSearchForm(e){this.resetForm(e),this.searchForm.user_status=this.user_status[0].value},search(){this.page_no=1,this.page_size=this.page_sizes[0],this.getUserList()}}},i=l,n=s(1001),p=(0,n.Z)(i,r,a,!1,null,"e2f9462a",null),d=p.exports},86:function(e,t,s){s.d(t,{Bv:function(){return n},KM:function(){return i},Kb:function(){return l},QR:function(){return p},_h:function(){return u},pv:function(){return a},sX:function(){return o},st:function(){return r}});const r="正常",a="封禁",o="正常",u="封禁",l="管理员",i="用户",n="使用中",p="空闲中"}}]);
//# sourceMappingURL=778.315622ce.js.map